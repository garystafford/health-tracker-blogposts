Àÿ
tC:\Users\gary.stafford\Source\Repos\health-tracker-blogposts\HealthTracker.WcfService\HealthTrackerWcfService.svc.cs
	namespace 	
HealthTracker
 
. 

WcfService "
{		 
[

 
ServiceBehavior

 
(

 
AddressFilterMode

 &
=

' (
AddressFilterMode

) :
.

: ;
Any

; >
)

> ?
]

? @
public 

class #
HealthTrackerWcfService (
:) *$
IHealthTrackerWcfService+ C
{ 
private 
readonly 
DateTime !
_today" (
=) *
DateTime+ 3
.3 4
Now4 7
.7 8
Date8 <
;< =
private 
static !
HealthTrackerEntities ,
GetDbContext- 9
(9 :
): ;
{ 	
return 
new !
HealthTrackerEntities ,
(, -
)- .
;. /
} 	
public 
bool 
InsertPerson  
(  !
Person! '
person( .
). /
{ 	
try 
{ 
using 
( 
var 
	dbContext $
=% &
GetDbContext' 3
(3 4
)4 5
)5 6
{ 
	dbContext   
.   
People   $
.  $ %
Add  % (
(  ( )
new  ) ,

DataAccess  - 7
.  7 8
DbFirst  8 ?
.  ? @
Person  @ F
{  G H
Name  I M
=  N O
person  P V
.  V W
Name  W [
}  \ ]
)  ] ^
;  ^ _
	dbContext!! 
.!! 
SaveChanges!! )
(!!) *
)!!* +
;!!+ ,
return"" 
true"" 
;""  
}## 
}$$ 
catch%% 
(%% 
	Exception%% 
	exception%% &
)%%& '
{&& 
Debug'' 
.'' 
	WriteLine'' 
(''  
	exception''  )
)'') *
;''* +
return(( 
false(( 
;(( 
})) 
}** 	
public11 
bool11 
UpdatePerson11  
(11  !
Person11! '
person11( .
)11. /
{22 	
try33 
{44 
using55 
(55 
var55 
	dbContext55 $
=55% &
GetDbContext55' 3
(553 4
)554 5
)555 6
{66 
var77 
personToUpdate77 &
=77' (
	dbContext77) 2
.772 3
People773 9
.779 :
First77: ?
(77? @
p77@ A
=>77B D
p77E F
.77F G
PersonId77G O
==77P R
person77S Y
.77Y Z
PersonId77Z b
)77b c
;77c d
if88 
(88 
personToUpdate88 &
==88' )
null88* .
)88. /
return880 6
false887 <
;88< =
personToUpdate99 "
.99" #
Name99# '
=99( )
person99* 0
.990 1
Name991 5
;995 6
	dbContext:: 
.:: 
SaveChanges:: )
(::) *
)::* +
;::+ ,
return;; 
true;; 
;;;  
}<< 
}== 
catch>> 
(>> 
	Exception>> 
	exception>> &
)>>& '
{?? 
Debug@@ 
.@@ 
	WriteLine@@ 
(@@  
	exception@@  )
)@@) *
;@@* +
returnAA 
falseAA 
;AA 
}BB 
}CC 	
publicJJ 
boolJJ 
DeletePersonJJ  
(JJ  !
intJJ! $
personIdJJ% -
)JJ- .
{KK 	
tryLL 
{MM 
usingNN 
(NN 
varNN 
	dbContextNN $
=NN% &
GetDbContextNN' 3
(NN3 4
)NN4 5
)NN5 6
{OO 
varPP 
personToDeletePP &
=PP' (
	dbContextPP) 2
.PP2 3
PeoplePP3 9
.PP9 :
FirstPP: ?
(PP? @
pPP@ A
=>PPB D
pPPE F
.PPF G
PersonIdPPG O
==PPP R
personIdPPS [
)PP[ \
;PP\ ]
ifQQ 
(QQ 
personToDeleteQQ &
==QQ' )
nullQQ* .
)QQ. /
returnQQ0 6
falseQQ7 <
;QQ< =
	dbContextRR 
.RR 
PeopleRR $
.RR$ %
RemoveRR% +
(RR+ ,
personToDeleteRR, :
)RR: ;
;RR; <
	dbContextSS 
.SS 
SaveChangesSS )
(SS) *
)SS* +
;SS+ ,
returnTT 
trueTT 
;TT  
}UU 
}VV 
catchWW 
(WW 
	ExceptionWW 
	exceptionWW &
)WW& '
{XX 
DebugYY 
.YY 
	WriteLineYY 
(YY  
	exceptionYY  )
)YY) *
;YY* +
returnZZ 
falseZZ 
;ZZ 
}[[ 
}\\ 	
publiccc 
intcc 
GetPersonIdcc 
(cc 
stringcc %

personNamecc& 0
)cc0 1
{dd 	
tryee 
{ff 
usinggg 
(gg 
vargg 
	dbContextgg $
=gg% &
GetDbContextgg' 3
(gg3 4
)gg4 5
)gg5 6
{hh 
varii 
personIdii  
=ii! "
	dbContextii# ,
.ii, -
Peopleii- 3
.jj, -
Wherejj- 2
(jj2 3
personjj3 9
=>jj: <
personjj= C
.jjC D
NamejjD H
==jjI K

personNamejjL V
)jjV W
.kk, -
Selectkk- 3
(kk3 4
personkk4 :
=>kk; =
personkk> D
.kkD E
PersonIdkkE M
)kkM N
.ll, -
Firstll- 2
(ll2 3
)ll3 4
;ll4 5
returnmm 
personIdmm #
;mm# $
}nn 
}oo 
catchpp 
(pp 
	Exceptionpp 
	exceptionpp &
)pp& '
{qq 
Debugrr 
.rr 
	WriteLinerr 
(rr  
	exceptionrr  )
)rr) *
;rr* +
returnss 
-ss 
$numss 
;ss 
}tt 
}uu 	
public{{ 
List{{ 
<{{ 
Person{{ 
>{{ 
	GetPeople{{ %
({{% &
){{& '
{|| 	
try}} 
{~~ 
using 
( 
var 
	dbContext $
=% &
GetDbContext' 3
(3 4
)4 5
)5 6
{
ÄÄ 
var
ÅÅ 
people
ÅÅ 
=
ÅÅ  
(
ÅÅ! "
	dbContext
ÅÅ" +
.
ÅÅ+ ,
People
ÅÅ, 2
.
ÅÅ2 3
Select
ÅÅ3 9
(
ÅÅ9 :
p
ÅÅ: ;
=>
ÅÅ< >
p
ÅÅ? @
)
ÅÅ@ A
)
ÅÅA B
;
ÅÅB C
var
ÇÇ 

peopleList
ÇÇ "
=
ÇÇ# $
people
ÇÇ% +
.
ÇÇ+ ,
Select
ÇÇ, 2
(
ÇÇ2 3
p
ÇÇ3 4
=>
ÇÇ5 7
new
ÇÇ8 ;
Person
ÇÇ< B
{
ÉÉ 
PersonId
ÑÑ  
=
ÑÑ! "
p
ÑÑ# $
.
ÑÑ$ %
PersonId
ÑÑ% -
,
ÑÑ- .
Name
ÖÖ 
=
ÖÖ 
p
ÖÖ  
.
ÖÖ  !
Name
ÖÖ! %
}
ÜÜ 
)
ÜÜ 
.
ÜÜ 
ToList
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ  
return
àà 

peopleList
àà %
;
àà% &
}
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
	exception
ãã &
)
ãã& '
{
åå 
Debug
çç 
.
çç 
	WriteLine
çç 
(
çç  
	exception
çç  )
)
çç) *
;
çç* +
return
éé 
null
éé 
;
éé 
}
èè 
}
êê 	
public
ññ 
bool
ññ 

InsertMeal
ññ 
(
ññ 
Meal
ññ #
meal
ññ$ (
)
ññ( )
{
óó 	
try
òò 
{
ôô 
using
öö 
(
öö 
var
öö 
	dbContext
öö $
=
öö% &
GetDbContext
öö' 3
(
öö3 4
)
öö4 5
)
öö5 6
{
õõ 
	dbContext
úú 
.
úú 
Meals
úú #
.
úú# $
Add
úú$ '
(
úú' (
new
úú( +

DataAccess
úú, 6
.
úú6 7
DbFirst
úú7 >
.
úú> ?
Meal
úú? C
{
ùù 
PersonId
ûû  
=
ûû! "
meal
ûû# '
.
ûû' (
PersonId
ûû( 0
,
ûû0 1
Date
üü 
=
üü 
_today
üü %
,
üü% &

MealTypeId
†† "
=
††# $
meal
††% )
.
††) *

MealTypeId
††* 4
,
††4 5
Description
°° #
=
°°$ %
meal
°°& *
.
°°* +
Description
°°+ 6
}
¢¢ 
)
¢¢ 
;
¢¢ 
	dbContext
££ 
.
££ 
SaveChanges
££ )
(
££) *
)
££* +
;
££+ ,
return
§§ 
true
§§ 
;
§§  
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
	exception
ßß &
)
ßß& '
{
®® 
Debug
©© 
.
©© 
	WriteLine
©© 
(
©©  
	exception
©©  )
)
©©) *
;
©©* +
return
™™ 
false
™™ 
;
™™ 
}
´´ 
}
¨¨ 	
public
≥≥ 
bool
≥≥ 

DeleteMeal
≥≥ 
(
≥≥ 
int
≥≥ "
mealId
≥≥# )
)
≥≥) *
{
¥¥ 	
try
µµ 
{
∂∂ 
using
∑∑ 
(
∑∑ 
var
∑∑ 
	dbContext
∑∑ $
=
∑∑% &
GetDbContext
∑∑' 3
(
∑∑3 4
)
∑∑4 5
)
∑∑5 6
{
∏∏ 
var
ππ 
mealToDelete
ππ $
=
ππ% &
	dbContext
ππ' 0
.
ππ0 1
Meals
ππ1 6
.
ππ6 7
First
ππ7 <
(
ππ< =
m
ππ= >
=>
ππ? A
m
ππB C
.
ππC D

MealTypeId
ππD N
==
ππO Q
mealId
ππR X
)
ππX Y
;
ππY Z
if
∫∫ 
(
∫∫ 
mealToDelete
∫∫ $
==
∫∫% '
null
∫∫( ,
)
∫∫, -
return
∫∫. 4
false
∫∫5 :
;
∫∫: ;
	dbContext
ªª 
.
ªª 
Meals
ªª #
.
ªª# $
Remove
ªª$ *
(
ªª* +
mealToDelete
ªª+ 7
)
ªª7 8
;
ªª8 9
	dbContext
ºº 
.
ºº 
SaveChanges
ºº )
(
ºº) *
)
ºº* +
;
ºº+ ,
return
ΩΩ 
true
ΩΩ 
;
ΩΩ  
}
ææ 
}
øø 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
	exception
¿¿ &
)
¿¿& '
{
¡¡ 
Debug
¬¬ 
.
¬¬ 
	WriteLine
¬¬ 
(
¬¬  
	exception
¬¬  )
)
¬¬) *
;
¬¬* +
return
√√ 
false
√√ 
;
√√ 
}
ƒƒ 
}
≈≈ 	
public
ÃÃ 
List
ÃÃ 
<
ÃÃ 

MealDetail
ÃÃ 
>
ÃÃ 
GetMeals
ÃÃ  (
(
ÃÃ( )
int
ÃÃ) ,
personId
ÃÃ- 5
)
ÃÃ5 6
{
ÕÕ 	
try
ŒŒ 
{
œœ 
using
–– 
(
–– 
var
–– 
	dbContext
–– $
=
––% &
GetDbContext
––' 3
(
––3 4
)
––4 5
)
––5 6
{
—— 
var
““ 
meals
““ 
=
““ 
	dbContext
““  )
.
““) *
Meals
““* /
.
““/ 0
Where
““0 5
(
““5 6
m
““6 7
=>
““8 :
m
““; <
.
““< =
PersonId
““= E
==
““F H
personId
““I Q
)
““Q R
.
””) *
Select
””* 0
(
””0 1
m
””1 2
=>
””3 5
new
””6 9

MealDetail
””: D
{
‘‘) *
MealId
’’- 3
=
’’4 5
m
’’6 7
.
’’7 8
MealId
’’8 >
,
’’> ?
Date
÷÷- 1
=
÷÷2 3
m
÷÷4 5
.
÷÷5 6
Date
÷÷6 :
,
÷÷: ;
Type
◊◊- 1
=
◊◊2 3
m
◊◊4 5
.
◊◊5 6
MealType
◊◊6 >
.
◊◊> ?
Description
◊◊? J
,
◊◊J K
Description
ÿÿ- 8
=
ÿÿ9 :
m
ÿÿ; <
.
ÿÿ< =
Description
ÿÿ= H
}
ŸŸ) *
)
ŸŸ* +
.
ŸŸ+ ,
ToList
ŸŸ, 2
(
ŸŸ2 3
)
ŸŸ3 4
;
ŸŸ4 5
return
⁄⁄ 
meals
⁄⁄  
;
⁄⁄  !
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
	Exception
›› 
	exception
›› &
)
››& '
{
ﬁﬁ 
Debug
ﬂﬂ 
.
ﬂﬂ 
	WriteLine
ﬂﬂ 
(
ﬂﬂ  
	exception
ﬂﬂ  )
)
ﬂﬂ) *
;
ﬂﬂ* +
return
‡‡ 
null
‡‡ 
;
‡‡ 
}
·· 
}
‚‚ 	
public
ÈÈ 
bool
ÈÈ 
InsertActivity
ÈÈ "
(
ÈÈ" #
Activity
ÈÈ# +
activity
ÈÈ, 4
)
ÈÈ4 5
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
using
ÌÌ 
(
ÌÌ 
var
ÌÌ 
	dbContext
ÌÌ $
=
ÌÌ% &
GetDbContext
ÌÌ' 3
(
ÌÌ3 4
)
ÌÌ4 5
)
ÌÌ5 6
{
ÓÓ 
	dbContext
ÔÔ 
.
ÔÔ 

Activities
ÔÔ (
.
ÔÔ( )
Add
ÔÔ) ,
(
ÔÔ, -
new
ÔÔ- 0

DataAccess
ÔÔ1 ;
.
ÔÔ; <
DbFirst
ÔÔ< C
.
ÔÔC D
Activity
ÔÔD L
{
 
PersonId
ÒÒ  
=
ÒÒ! "
activity
ÒÒ# +
.
ÒÒ+ ,
PersonId
ÒÒ, 4
,
ÒÒ4 5
Date
ÚÚ 
=
ÚÚ 
_today
ÚÚ %
,
ÚÚ% &
ActivityTypeId
ÛÛ &
=
ÛÛ' (
activity
ÛÛ) 1
.
ÛÛ1 2
ActivityTypeId
ÛÛ2 @
,
ÛÛ@ A
Notes
ÙÙ 
=
ÙÙ 
activity
ÙÙ  (
.
ÙÙ( )
Notes
ÙÙ) .
}
ıı 
)
ıı 
;
ıı 
	dbContext
ˆˆ 
.
ˆˆ 
SaveChanges
ˆˆ )
(
ˆˆ) *
)
ˆˆ* +
;
ˆˆ+ ,
return
˜˜ 
true
˜˜ 
;
˜˜  
}
¯¯ 
}
˘˘ 
catch
˙˙ 
(
˙˙ 
	Exception
˙˙ 
	exception
˙˙ &
)
˙˙& '
{
˚˚ 
Debug
¸¸ 
.
¸¸ 
	WriteLine
¸¸ 
(
¸¸  
	exception
¸¸  )
)
¸¸) *
;
¸¸* +
return
˝˝ 
false
˝˝ 
;
˝˝ 
}
˛˛ 
}
ÄÄ 	
public
áá 
bool
áá 
DeleteActivity
áá "
(
áá" #
int
áá# &

activityId
áá' 1
)
áá1 2
{
àà 	
try
ââ 
{
ää 
using
ãã 
(
ãã 
var
ãã 
	dbContext
ãã $
=
ãã% &
GetDbContext
ãã' 3
(
ãã3 4
)
ãã4 5
)
ãã5 6
{
åå 
var
çç 
activityToDelete
çç (
=
çç) *
	dbContext
çç+ 4
.
çç4 5

Activities
çç5 ?
.
çç? @
First
çç@ E
(
ççE F
a
ççF G
=>
ççH J
a
ççK L
.
ççL M

ActivityId
ççM W
==
ççX Z

activityId
çç[ e
)
ççe f
;
ççf g
if
éé 
(
éé 
activityToDelete
éé (
==
éé) +
null
éé, 0
)
éé0 1
return
éé2 8
false
éé9 >
;
éé> ?
	dbContext
èè 
.
èè 

Activities
èè (
.
èè( )
Remove
èè) /
(
èè/ 0
activityToDelete
èè0 @
)
èè@ A
;
èèA B
	dbContext
êê 
.
êê 
SaveChanges
êê )
(
êê) *
)
êê* +
;
êê+ ,
return
ëë 
true
ëë 
;
ëë  
}
íí 
}
ìì 
catch
îî 
(
îî 
	Exception
îî 
	exception
îî &
)
îî& '
{
ïï 
Debug
ññ 
.
ññ 
	WriteLine
ññ 
(
ññ  
	exception
ññ  )
)
ññ) *
;
ññ* +
return
óó 
false
óó 
;
óó 
}
òò 
}
ôô 	
public
†† 
List
†† 
<
†† 
ActivityDetail
†† "
>
††" #
GetActivities
††$ 1
(
††1 2
int
††2 5
personId
††6 >
)
††> ?
{
°° 	
try
¢¢ 
{
££ 
using
§§ 
(
§§ 
var
§§ 
	dbContext
§§ $
=
§§% &
GetDbContext
§§' 3
(
§§3 4
)
§§4 5
)
§§5 6
{
•• 
var
¶¶ 

activities
¶¶ "
=
¶¶# $
	dbContext
¶¶% .
.
¶¶. /

Activities
¶¶/ 9
.
¶¶9 :
Where
¶¶: ?
(
¶¶? @
a
¶¶@ A
=>
¶¶B D
a
¶¶E F
.
¶¶F G
PersonId
¶¶G O
==
¶¶P R
personId
¶¶S [
)
¶¶[ \
.
ßß. /
Select
ßß/ 5
(
ßß5 6
a
ßß6 7
=>
ßß8 :
new
ßß; >
ActivityDetail
ßß? M
{
®®. /

ActivityId
©©2 <
=
©©= >
a
©©? @
.
©©@ A

ActivityId
©©A K
,
©©K L
Date
™™2 6
=
™™7 8
a
™™9 :
.
™™: ;
Date
™™; ?
,
™™? @
Type
´´2 6
=
´´7 8
a
´´9 :
.
´´: ;
ActivityType
´´; G
.
´´G H
Description
´´H S
,
´´S T
Notes
¨¨2 7
=
¨¨8 9
a
¨¨: ;
.
¨¨; <
Notes
¨¨< A
}
≠≠. /
)
≠≠/ 0
.
≠≠0 1
ToList
≠≠1 7
(
≠≠7 8
)
≠≠8 9
;
≠≠9 :
return
ÆÆ 

activities
ÆÆ %
;
ÆÆ% &
}
ØØ 
}
∞∞ 
catch
±± 
(
±± 
	Exception
±± 
	exception
±± &
)
±±& '
{
≤≤ 
Debug
≥≥ 
.
≥≥ 
	WriteLine
≥≥ 
(
≥≥  
	exception
≥≥  )
)
≥≥) *
;
≥≥* +
return
¥¥ 
null
¥¥ 
;
¥¥ 
}
µµ 
}
∂∂ 	
public
ææ 
bool
ææ %
UpdateOrInsertHydration
ææ +
(
ææ+ ,
int
ææ, /
personId
ææ0 8
)
ææ8 9
{
øø 	
try
¿¿ 
{
¡¡ 
using
¬¬ 
(
¬¬ 
var
¬¬ 
	dbContext
¬¬ $
=
¬¬% &
GetDbContext
¬¬' 3
(
¬¬3 4
)
¬¬4 5
)
¬¬5 6
{
√√ 
var
ƒƒ 
existingHydration
ƒƒ )
=
ƒƒ* +
	dbContext
ƒƒ, 5
.
ƒƒ5 6

Hydrations
ƒƒ6 @
.
ƒƒ@ A
First
ƒƒA F
(
ƒƒF G
	hydration
≈≈ !
=>
≈≈" $
	hydration
≈≈% .
.
≈≈. /
PersonId
≈≈/ 7
==
≈≈8 :
personId
≈≈; C
&&
∆∆% '
	hydration
∆∆( 1
.
∆∆1 2
Date
∆∆2 6
==
∆∆7 9
_today
∆∆: @
)
∆∆@ A
;
∆∆A B
if
»» 
(
»» 
existingHydration
»» )
!=
»»* ,
null
»»- 1
&&
»»2 4
existingHydration
»»5 F
.
»»F G
HydrationId
»»G R
>
»»S T
$num
»»U V
)
»»V W
{
…… 
existingHydration
   )
.
  ) *
Count
  * /
++
  / 1
;
  1 2
	dbContext
ÀÀ !
.
ÀÀ! "
SaveChanges
ÀÀ" -
(
ÀÀ- .
)
ÀÀ. /
;
ÀÀ/ 0
return
ÃÃ 
true
ÃÃ #
;
ÃÃ# $
}
ÕÕ 
	dbContext
œœ 
.
œœ 

Hydrations
œœ (
.
œœ( )
Add
œœ) ,
(
œœ, -
new
œœ- 0
	Hydration
œœ1 :
{
–– 
PersonId
——  
=
——! "
personId
——# +
,
——+ ,
Date
““ 
=
““ 
_today
““ %
,
““% &
Count
”” 
=
”” 
$num
””  !
}
‘‘ 
)
‘‘ 
;
‘‘ 
	dbContext
’’ 
.
’’ 
SaveChanges
’’ )
(
’’) *
)
’’* +
;
’’+ ,
return
÷÷ 
true
÷÷ 
;
÷÷  
}
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
	exception
ŸŸ &
)
ŸŸ& '
{
⁄⁄ 
Debug
€€ 
.
€€ 
	WriteLine
€€ 
(
€€  
	exception
€€  )
)
€€) *
;
€€* +
return
‹‹ 
false
‹‹ 
;
‹‹ 
}
›› 
}
ﬁﬁ 	
public
ÊÊ 
List
ÊÊ 
<
ÊÊ 
PersonSummaryView
ÊÊ %
>
ÊÊ% &"
GetPersonSummaryView
ÊÊ' ;
(
ÊÊ; <
int
ÊÊ< ?
personId
ÊÊ@ H
)
ÊÊH I
{
ÁÁ 	
try
ËË 
{
ÈÈ 
using
ÍÍ 
(
ÍÍ 
var
ÍÍ 
	dbContext
ÍÍ $
=
ÍÍ% &
GetDbContext
ÍÍ' 3
(
ÍÍ3 4
)
ÍÍ4 5
)
ÍÍ5 6
{
ÎÎ 
var
ÏÏ 

personView
ÏÏ "
=
ÏÏ# $
(
ÏÏ% &
	dbContext
ÏÏ& /
.
ÏÏ/ 0 
PersonSummaryViews
ÏÏ0 B
.
ÌÌ/ 0
Where
ÌÌ0 5
(
ÌÌ5 6
p
ÌÌ6 7
=>
ÌÌ8 :
p
ÌÌ; <
.
ÌÌ< =
PersonId
ÌÌ= E
==
ÌÌF H
personId
ÌÌI Q
)
ÌÌQ R
)
ÌÌR S
.
ÓÓ/ 0
ToList
ÓÓ0 6
(
ÓÓ6 7
)
ÓÓ7 8
;
ÓÓ8 9
return
ÔÔ 

personView
ÔÔ %
;
ÔÔ% &
}
 
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
	exception
ÚÚ &
)
ÚÚ& '
{
ÛÛ 
Debug
ÙÙ 
.
ÙÙ 
	WriteLine
ÙÙ 
(
ÙÙ  
	exception
ÙÙ  )
)
ÙÙ) *
;
ÙÙ* +
return
ıı 
null
ıı 
;
ıı 
}
ˆˆ 
}
˜˜ 	
public
ˇˇ 
List
ˇˇ 
<
ˇˇ %
GetPersonSummary_Result
ˇˇ +
>
ˇˇ+ ,(
GetPersonSummaryStoredProc
ˇˇ- G
(
ˇˇG H
int
ˇˇH K
personId
ˇˇL T
)
ˇˇT U
{
ÄÄ 	
try
ÅÅ 
{
ÇÇ 
using
ÉÉ 
(
ÉÉ 
var
ÉÉ 
	dbContext
ÉÉ $
=
ÉÉ% &
GetDbContext
ÉÉ' 3
(
ÉÉ3 4
)
ÉÉ4 5
)
ÉÉ5 6
{
ÑÑ 
var
ÖÖ 

personView
ÖÖ "
=
ÖÖ# $
(
ÖÖ% &
	dbContext
ÖÖ& /
.
ÖÖ/ 0
GetPersonSummary
ÖÖ0 @
(
ÖÖ@ A
personId
ÖÖA I
)
ÖÖI J
.
ÜÜ/ 0
Where
ÜÜ0 5
(
ÜÜ5 6
p
ÜÜ6 7
=>
ÜÜ8 :
p
ÜÜ; <
.
ÜÜ< =
PersonId
ÜÜ= E
==
ÜÜF H
personId
ÜÜI Q
)
ÜÜQ R
)
ÜÜR S
.
áá/ 0
ToList
áá0 6
(
áá6 7
)
áá7 8
;
áá8 9
return
àà 

personView
àà %
;
àà% &
}
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
	exception
ãã &
)
ãã& '
{
åå 
Debug
çç 
.
çç 
	WriteLine
çç 
(
çç  
	exception
çç  )
)
çç) *
;
çç* +
return
éé 
null
éé 
;
éé 
}
èè 
}
êê 	
}
ìì 
public
óó 

class
óó 
Person
óó 
{
òò 
public
ôô 
int
ôô 
PersonId
ôô 
{
ôô 
get
ôô !
;
ôô! "
set
ôô# &
;
ôô& '
}
ôô( )
public
öö 
string
öö 
Name
öö 
{
öö 
get
öö  
;
öö  !
set
öö" %
;
öö% &
}
öö' (
}
õõ 
public
ùù 

class
ùù 
Meal
ùù 
{
ûû 
public
üü 
int
üü 
PersonId
üü 
{
üü 
get
üü !
;
üü! "
set
üü# &
;
üü& '
}
üü( )
public
†† 
int
†† 

MealTypeId
†† 
{
†† 
get
††  #
;
††# $
set
††% (
;
††( )
}
††* +
public
°° 
string
°° 
Description
°° !
{
°°" #
get
°°$ '
;
°°' (
set
°°) ,
;
°°, -
}
°°. /
}
¢¢ 
public
§§ 

class
§§ 

MealDetail
§§ 
{
•• 
public
¶¶ 
int
¶¶ 
MealId
¶¶ 
{
¶¶ 
get
¶¶ 
;
¶¶  
set
¶¶! $
;
¶¶$ %
}
¶¶& '
public
ßß 
DateTime
ßß 
Date
ßß 
{
ßß 
get
ßß "
;
ßß" #
set
ßß$ '
;
ßß' (
}
ßß) *
public
®® 
string
®® 
Type
®® 
{
®® 
get
®®  
;
®®  !
set
®®" %
;
®®% &
}
®®' (
public
©© 
string
©© 
Description
©© !
{
©©" #
get
©©$ '
;
©©' (
set
©©) ,
;
©©, -
}
©©. /
}
™™ 
public
¨¨ 

class
¨¨ 
Activity
¨¨ 
{
≠≠ 
public
ÆÆ 
int
ÆÆ 
PersonId
ÆÆ 
{
ÆÆ 
get
ÆÆ !
;
ÆÆ! "
set
ÆÆ# &
;
ÆÆ& '
}
ÆÆ( )
public
ØØ 
int
ØØ 
ActivityTypeId
ØØ !
{
ØØ" #
get
ØØ$ '
;
ØØ' (
set
ØØ) ,
;
ØØ, -
}
ØØ. /
public
∞∞ 
string
∞∞ 
Notes
∞∞ 
{
∞∞ 
get
∞∞ !
;
∞∞! "
set
∞∞# &
;
∞∞& '
}
∞∞( )
}
±± 
public
≥≥ 

class
≥≥ 
ActivityDetail
≥≥ 
{
¥¥ 
public
µµ 
int
µµ 

ActivityId
µµ 
{
µµ 
get
µµ  #
;
µµ# $
set
µµ% (
;
µµ( )
}
µµ* +
public
∂∂ 
DateTime
∂∂ 
Date
∂∂ 
{
∂∂ 
get
∂∂ "
;
∂∂" #
set
∂∂$ '
;
∂∂' (
}
∂∂) *
public
∑∑ 
string
∑∑ 
Type
∑∑ 
{
∑∑ 
get
∑∑  
;
∑∑  !
set
∑∑" %
;
∑∑% &
}
∑∑' (
public
∏∏ 
string
∏∏ 
Notes
∏∏ 
{
∏∏ 
get
∏∏ !
;
∏∏! "
set
∏∏# &
;
∏∏& '
}
∏∏( )
}
ππ 
}ºº Ô0
qC:\Users\gary.stafford\Source\Repos\health-tracker-blogposts\HealthTracker.WcfService\IHealthTrackerWcfService.cs
	namespace 	
HealthTracker
 
. 

WcfService "
{ 
[ 
ServiceContract 
] 
public		 

	interface		 $
IHealthTrackerWcfService		 -
{

 
[ 	
OperationContract	 
] 
[ 	
	WebInvoke	 
( 
UriTemplate 
=  
$str! @
,@ A
Method 
= 
$str 
) 
] 
int 
GetPersonId 
( 
string 

personName )
)) *
;* +
[ 	
OperationContract	 
] 
[ 	
	WebInvoke	 
( 
UriTemplate 
=  
$str! ,
,, -
Method 
= 
$str 
) 
] 
List 
< 
Person 
> 
	GetPeople 
( 
)  
;  !
[ 	
OperationContract	 
] 
[ 	
	WebInvoke	 
( 
UriTemplate 
=  
$str! K
,K L
Method 
= 
$str 
) 
] 
List 
< #
GetPersonSummary_Result $
>$ %&
GetPersonSummaryStoredProc& @
(@ A
intA D
personIdE M
)M N
;N O
[ 	
OperationContract	 
] 
[ 	
	WebInvoke	 
( 
UriTemplate 
=  
$str! /
,/ 0
Method 
= 
$str 
) 
] 
bool 
InsertPerson 
( 
Person  
person! '
)' (
;( )
[ 	
OperationContract	 
] 
[   	
	WebInvoke  	 
(   
UriTemplate   
=    
$str  ! /
,  / 0
Method!! 
=!! 
$str!! 
)!! 
]!! 
bool"" 
UpdatePerson"" 
("" 
Person""  
person""! '
)""' (
;""( )
[$$ 	
OperationContract$$	 
]$$ 
[%% 	
	WebInvoke%%	 
(%% 
UriTemplate%% 
=%%  
$str%%! =
,%%= >
Method&& 
=&& 
$str&& 
)&& 
]&& 
bool'' 
DeletePerson'' 
('' 
int'' 
personId'' &
)''& '
;''' (
[)) 	
OperationContract))	 
])) 
[** 	
	WebInvoke**	 
(** 
UriTemplate** 
=**  
$str**! H
,**H I
Method++ 
=++ 
$str++ 
)++ 
]++ 
bool,, #
UpdateOrInsertHydration,, $
(,,$ %
int,,% (
personId,,) 1
),,1 2
;,,2 3
[.. 	
OperationContract..	 
].. 
[// 	
	WebInvoke//	 
(// 
UriTemplate// 
=//  
$str//! 1
,//1 2
Method00 
=00 
$str00 
)00 
]00 
bool11 
InsertActivity11 
(11 
Activity11 $
activity11% -
)11- .
;11. /
[33 	
OperationContract33	 
]33 
[44 	
	WebInvoke44	 
(44 
UriTemplate44 
=44  
$str44! A
,44A B
Method55 
=55 
$str55 
)55 
]55 
bool66 
DeleteActivity66 
(66 
int66 

activityId66  *
)66* +
;66+ ,
[88 	
OperationContract88	 
]88 
[99 	
	WebInvoke99	 
(99 
UriTemplate99 
=99  
$str99! >
,99> ?
Method:: 
=:: 
$str:: 
):: 
]:: 
List;; 
<;; 
ActivityDetail;; 
>;; 
GetActivities;; *
(;;* +
int;;+ .
personId;;/ 7
);;7 8
;;;8 9
[== 	
OperationContract==	 
]== 
[>> 	
	WebInvoke>>	 
(>> 
UriTemplate>> 
=>>  
$str>>! -
,>>- .
Method?? 
=?? 
$str?? 
)?? 
]?? 
bool@@ 

InsertMeal@@ 
(@@ 
Meal@@ 
meal@@ !
)@@! "
;@@" #
[BB 	
OperationContractBB	 
]BB 
[CC 	
	WebInvokeCC	 
(CC 
UriTemplateCC 
=CC  
$strCC! 9
,CC9 :
MethodDD 
=DD 
$strDD 
)DD 
]DD 
boolEE 

DeleteMealEE 
(EE 
intEE 
mealIdEE "
)EE" #
;EE# $
[GG 	
OperationContractGG	 
]GG 
[HH 	
	WebInvokeHH	 
(HH 
UriTemplateHH 
=HH  
$strHH! 9
,HH9 :
MethodII 
=II 
$strII 
)II 
]II 
ListJJ 
<JJ 

MealDetailJJ 
>JJ 
GetMealsJJ !
(JJ! "
intJJ" %
personIdJJ& .
)JJ. /
;JJ/ 0
[LL 	
OperationContractLL	 
]LL 
[MM 	
	WebInvokeMM	 
(MM 
UriTemplateMM 
=MM  
$strMM! E
,MME F
MethodNN 
=NN 
$strNN 
)NN 
]NN 
ListOO 
<OO 
PersonSummaryViewOO 
>OO  
GetPersonSummaryViewOO  4
(OO4 5
intOO5 8
personIdOO9 A
)OOA B
;OOB C
}PP 
}QQ õ
pC:\Users\gary.stafford\Source\Repos\health-tracker-blogposts\HealthTracker.WcfService\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 6
)6 7
]7 8
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str &
)& '
]' (
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 8
)8 9
]9 :
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 9
)9 :
]: ;
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *